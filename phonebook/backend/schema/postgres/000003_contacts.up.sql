CREATE TABLE IF NOT EXISTS contacts (
    id SERIAL PRIMARY KEY,
    department_id INT NOT NULL REFERENCES departments(id) ON DELETE RESTRICT,
    
    name VARCHAR(256),
    position VARCHAR(256) NOT NULL,
    phone VARCHAR(20) NOT NULL,
    email VARCHAR(256) NOT NULL,
    room VARCHAR(16) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

COMMENT ON TABLE contacts IS 'Контактные данные сотрудников';
COMMENT ON COLUMN contacts.name IS 'ФИО';
COMMENT ON COLUMN contacts.position IS 'Должность';
COMMENT ON COLUMN contacts.phone IS 'Номер телефона';
COMMENT ON COLUMN contacts.email IS 'Электронная почта';
COMMENT ON COLUMN contacts.room IS 'Номер кабинета';
COMMENT ON COLUMN contacts.department_id IS 'Ссылка на отдел';

CREATE INDEX IF NOT EXISTS idx_contacts_fullname 
    ON contacts (name);

CREATE INDEX IF NOT EXISTS idx_contacts_phone 
    ON contacts (phone);

CREATE INDEX IF NOT EXISTS idx_contacts_department 
    ON contacts (department_id);

CREATE OR REPLACE TRIGGER update_contacts_modtime
BEFORE UPDATE ON contacts
FOR EACH ROW
EXECUTE PROCEDURE update_modified_column();

-- First insert the department (исправлена опечатка в названии)
INSERT INTO departments (name) 
VALUES ('Кафедра информатики и вычислительной техники') 
ON CONFLICT (name) DO NOTHING;

-- Then insert all contacts with NULL/empty values where data is missing
INSERT INTO contacts (department_id, name, position, phone, email, room) 
VALUES 
(
    (SELECT id FROM departments WHERE name = 'Кафедра информатики и вычислительной техники'),
    'Дубенко Юрий Владимирович',
    'И.о. заведующего кафедрой, Доцент, д-р техн. наук, доцент ВАК по специальности 05.13.01',
    '(861) 255 03 91',
    'ivt@kubstu.ru',
    '121'
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информатики и вычислительной техники'),
    'Бабенко Геннадий Владимирович',
    'Доцент кафедры ИВТ, кандидат физико-математических наук',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информатики и вычислительной техники'),
    'Безнос Ольга Сергеевна',
    'Доцент кафедры. Кандидат технических наук, член ученого совета ИКСиИБ',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информатики и вычислительной техники'),
    'Богданов Виктор Владимирович',
    'Доцент кафедры. Кандидат технических наук, доцент',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информатики и вычислительной техники'),
    'Василенко Наталья Владимировна',
    'Доцент кафедры. Кандидат технических наук, доцент. Секретарь ГЭК кафедры',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информатики и вычислительной техники'),
    'Даутова Ирина Сергеевна',
    'Доцент кафедры. Кандидат технических наук. Ответственная за международную деятельность',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информатики и вычислительной техники'),
    'Дудник Людмила Николаевна',
    'Доцент кафедры. Кандидат технических наук. Ответственная за организацию подготовки магистров',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информатики и вычислительной техники'),
    'Кошевая Софья Евгеньевна',
    'Доцент кафедры. Кандидат технических наук',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информатики и вычислительной техники'),
    'Майорова Валерия Олеговна',
    'Старший преподаватель. Зам. директора по ЗФО ИКСиИБ',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информатики и вычислительной техники'),
    'Сальникова Надежда Олеговна',
    'Старший преподаватель',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информатики и вычислительной техники'),
    'Цуприков Александр Александрович',
    'Доцент кафедры. Кандидат технических наук, доцент',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информатики и вычислительной техники'),
    'Симонова Марина Викторовна',
    'Старший преподаватель',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информатики и вычислительной техники'),
    'Зарубина Софья Александровна',
    'Доцент кафедры. Кандидат технических наук, доцент',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информатики и вычислительной техники'),
    'Хисамов Франгиз Гильфанетдинович',
    'Профессор кафедры. Доктор технических наук, профессор',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информатики и вычислительной техники'),
    'Соловьев Виталий Евгеньевич',
    'Заведующий лабораторией кафедры ИВТ',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информатики и вычислительной техники'),
    'Чуцкова Валентина Ивановна',
    'Инженер 1 категории, секретарь кафедры ИВТ',
    '',
    '',
    ''
);

-- Вставка кафедры
INSERT INTO departments (name) 
VALUES ('Кафедра автоматизации производственных процессов') 
ON CONFLICT (name) DO NOTHING;

-- Вставка контактов сотрудников
INSERT INTO contacts (department_id, name, position, phone, email, room) 
VALUES 
(
    (SELECT id FROM departments WHERE name = 'Кафедра автоматизации производственных процессов'),
    'Дьяченко Роман Александрович',
    'И.о. заведующего кафедрой, директор института компьютерных систем и информационной безопасности, доктор технических наук, профессор',
    '+7 861 255-93-92',
    'djachenko.roman@kubstu.ru',
    '317'
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра автоматизации производственных процессов'),
    'Лубенцов Валерий Федорович',
    'Доктор технических наук, профессор',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра автоматизации производственных процессов'),
    'Лубенцова Елена Валерьевна',
    'Доктор технических наук, профессор',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра автоматизации производственных процессов'),
    'Суртаев Николай Алексеевич',
    'Кандидат технических наук, доцент',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра автоматизации производственных процессов'),
    'Левченко Владимир Иванович',
    'Кандидат технических наук, доцент',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра автоматизации производственных процессов'),
    'Кичкарь Илья Юрьевич',
    'Кандидат технических наук, доцент',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра автоматизации производственных процессов'),
    'Посмитная Лариса Александровна',
    'Старший преподаватель',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра автоматизации производственных процессов'),
    'Ожогова Екатерина Васильевна',
    'Старший преподаватель',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра автоматизации производственных процессов'),
    'Лужевский Никита Олегович',
    'Ассистент, Заведующий лабораторией',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра автоматизации производственных процессов'),
    'Демидов Владислав Анатольевич',
    'Ассистент',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра автоматизации производственных процессов'),
    'Саввиди Константин Лефтерович',
    'Ассистент',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра автоматизации производственных процессов'),
    'Артамонов Николай Михайлович',
    'Инженер 1 категории',
    '',
    '',
    '317'
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра автоматизации производственных процессов'),
    'Козлова Надежда Ивановна',
    'Инженер',
    '',
    '',
    '317'
);

-- Вставка кафедры
INSERT INTO departments (name) 
VALUES ('Кафедра информационных систем и программирования') 
ON CONFLICT (name) DO NOTHING;

-- Вставка контактов сотрудников
INSERT INTO contacts (department_id, name, position, phone, email, room) 
VALUES 
(
    (SELECT id FROM departments WHERE name = 'Кафедра информационных систем и программирования'),
    'Янаева Марина Викторовна',
    'Заведующий кафедрой, кандидат технических наук, доцент',
    '+7 861 255-15-09',
    'yanaevam@mail.ru',
    '334'
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информационных систем и программирования'),
    'Видовский Леонид Адольфович',
    'Доктор технических наук, доцент, профессор кафедры',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информационных систем и программирования'),
    'Зайков Владимир Полиевктович',
    'Доктор экономический наук, доцент, профессор кафедры',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информационных систем и программирования'),
    'Марков Виталий Николаевич',
    'Доктор технических наук, профессор кафедры',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информационных систем и программирования'),
    'Трофимов Виктор Маратович',
    'Доктор физико-математических наук, профессор кафедры',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информационных систем и программирования'),
    'Ковалева Ксения Александровна',
    'Кандидат экономических наук, доцент',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информационных систем и программирования'),
    'Мурлина Владислава Анатольевна',
    'Кандидат технических наук, доцент',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информационных систем и программирования'),
    'Мурлин Алексей Георгиевич',
    'Кандидат технических наук, доцент, ученый секретарь института',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информационных систем и программирования'),
    'Попова Ольга Борисовна',
    'Кандидат технических наук, доцент',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информационных систем и программирования'),
    'Шумков Евгений Александрович',
    'Кандидат технических наук, доцент',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информационных систем и программирования'),
    'Волик Александр Георгиевич',
    'Старший преподаватель',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информационных систем и программирования'),
    'Вонарх Юлия Сергеевна',
    'Старший преподаватель',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информационных систем и программирования'),
    'Горячих Анастасия Викторовна',
    'Старший преподаватель, инженер 1-ой категории',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информационных систем и программирования'),
    'Ковтун Александр Александрович',
    'Старший преподаватель',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информационных систем и программирования'),
    'Кушнир Надежда Владимировна',
    'Старший преподаватель',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информационных систем и программирования'),
    'Дьяченко Елена Викторовна',
    'Ассистент',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информационных систем и программирования'),
    'Косолапов Павел Александрович',
    'Ассистент',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информационных систем и программирования'),
    'Савинская Дина Николаевна',
    'Доцент кафедры (внешний совместитель)',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информационных систем и программирования'),
    'Ткаченко Василий Владимирович',
    'Доцент кафедры (внешний совместитель)',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информационных систем и программирования'),
    'Литовка Наталья Васильевна',
    'Старший преподаватель (внешний совместитель)',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информационных систем и программирования'),
    'Шиян Валерий Игоревич',
    'Ассистент',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информационных систем и программирования'),
    'Тер-Оганезова Жанна Сергеевна',
    'Заведующий лабораторией',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информационных систем и программирования'),
    'Рудник Наталья Тенгизиевна',
    'Инженер 1-й категории, старший преподаватель',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информационных систем и программирования'),
    'Акиндинов Никита Александрович',
    'Инженер 2-й категории',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информационных систем и программирования'),
    'Филевская Марина Сергеевна',
    'Инженер 2-й категории',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информационных систем и программирования'),
    'Шурубова Дарья Игоревна',
    'Лаборант',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информационных систем и программирования'),
    'Гашкевич Галина Витальевна',
    'Лаборант',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра информационных систем и программирования'),
    'Соловьев Руслан Антонович',
    'Лаборант',
    '',
    '',
    ''
);

-- Вставка кафедры
INSERT INTO departments (name) 
VALUES ('Кафедра кибербезопасности и защиты информации') 
ON CONFLICT (name) DO NOTHING;

-- Вставка контактов сотрудников
INSERT INTO contacts (department_id, name, position, phone, email, room) 
VALUES 
(
    (SELECT id FROM departments WHERE name = 'Кафедра кибербезопасности и защиты информации'),
    'Черкасов Александр Николаевич',
    'И.о. заведующего кафедрой, кандидат технических наук, доцент, Руководитель Исследовательского центра компьютерных технологий, систем управления и комплексной безопасности',
    '+7 961 501-74-55',
    '',
    '201'
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра кибербезопасности и защиты информации'),
    'Зангиев Таймураз Таймуразович',
    'Кандидат технических наук, доцент',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра кибербезопасности и защиты информации'),
    'Каширина Елена Ивановна',
    'Кандидат исторических наук, доцент',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра кибербезопасности и защиты информации'),
    'Козырь Наталья Сергеевна',
    'Кандидат экономических наук, доцент',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра кибербезопасности и защиты информации'),
    'Кучер Виктор Алексеевич',
    'Кандидат технических наук, профессор',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра кибербезопасности и защиты информации'),
    'Макарян Александр Самвелович',
    'Директор института, кандидат технических наук, доцент',
    '+7 861 259-60-83',
    'kzi@kubstu.ru',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра кибербезопасности и защиты информации'),
    'Оганесян Левон Левонович',
    'Кандидат экономических наук, доцент',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра кибербезопасности и защиты информации'),
    'Путято Михаил Михайлович',
    'Доцент',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра кибербезопасности и защиты информации'),
    'Федоров Сергей Юрьевич',
    'Старший преподаватель',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра кибербезопасности и защиты информации'),
    'Хализев Вячеслав Николаевич',
    'Кандидат технических наук, профессор',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра кибербезопасности и защиты информации'),
    'Частикова Вера Аркадьевна',
    'Кандидат технических наук, доцент',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра кибербезопасности и защиты информации'),
    'Шарай Вячеслав Александрович',
    'Кандидат технических наук, доцент',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра кибербезопасности и защиты информации'),
    'Антониади Георгий Дмитриевич',
    'Старший преподаватель',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра кибербезопасности и защиты информации'),
    'Левченко Алина Михайловна',
    'Ассистент',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра кибербезопасности и защиты информации'),
    'Басте Фатима Рашидовна',
    'Ассистент',
    '',
    '',
    ''
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра кибербезопасности и защиты информации'),
    'Рябченко Виталий Иванович',
    'Заведующий лабораторией',
    '',
    '',
    '316'
),
(
    (SELECT id FROM departments WHERE name = 'Кафедра кибербезопасности и защиты информации'),
    'Полыгалова Екатерина Александровна',
    'Инженер',
    '',
    '',
    '201'
);